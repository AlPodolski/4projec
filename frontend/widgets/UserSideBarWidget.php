<?php


namespace frontend\widgets;

use frontend\modules\chat\components\helpers\GetDialogsHelper;
use frontend\modules\events\models\Events;
use frontend\modules\user\models\Friends;
use frontend\modules\user\models\FriendsRequest;
use Yii;
use yii\base\Widget;


class UserSideBarWidget extends Widget
{

    public $form_id = 'addpostform-image';

    public function init()
    {
        parent::init(); // TODO: Change the autogenerated stub
    }

    public function run()
    {

        $countNotRead = GetDialogsHelper::getNotReadCount(Yii::$app->user->id);
        $countFriendsRequest = FriendsRequest::find()->where(['user_id' => Yii::$app->user->id])->count();

        $countNotReadEvents = Events::find()->where(['user_id' => Yii::$app->user->id])
            ->andWhere(['status' => Events::STATUS_NOT_READ] )->count();

        return $this->render('user-sidebar', [
            'form_id' => $this->form_id,
            'countNotRead' => $countNotRead,
            'countNotReadEvents' => $countNotReadEvents,
            'countFriendsRequest' => $countFriendsRequest
        ]);

        parent::run(); // TODO: Change the autogenerated stub
    }
}